<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bike Occupation - OS Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
            min-height: 100vh;
            color: #f8fafc;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .app-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .app-card:hover {
            transform: translateY(-8px) scale(1.02);
            background: rgba(255, 255, 255, 0.07);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }

        #lock-screen {
            position: fixed;
            inset: 0;
            background: #020617;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #lock-screen.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scale(1.1);
        }

        #password-input {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px;
            color: white;
            text-align: center;
            font-size: 24px;
            width: 260px;
            outline: none;
            transition: border-color 0.3s;
        }

        #password-input:focus {
            border-color: #3b82f6;
        }

        .page {
            display: none;
            width: 100%;
            animation: slideUp 0.5s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sim-stats {
            background: rgba(15, 23, 42, 0.6);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="pb-12">

    <!-- Global Header/Clock -->
    <header class="sim-stats sticky top-0 z-50 backdrop-blur-md px-6 py-4 flex flex-wrap justify-between items-center gap-4">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/20">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="5.5" cy="17.5" r="3.5"/><circle cx="18.5" cy="17.5" r="3.5"/><path d="M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-3 11.5V14l-3-3 4-3 2 3h2"/></svg>
            </div>
            <div>
                <h1 class="font-bold text-lg tracking-tight leading-none">BIKE OS</h1>
                <p id="greeting-text" class="text-xs text-slate-400 font-medium mt-1">Guest Access</p>
            </div>
        </div>

        <div class="flex items-center gap-4">
            <div class="text-right">
                <div id="sim-date-text" class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">DAY 1</div>
                <div id="sim-time-text" class="text-xl font-bold font-mono tracking-tighter">--:-- --</div>
            </div>
            <div id="pause-indicator" class="hidden px-2 py-1 bg-red-500/10 border border-red-500/20 rounded text-[10px] text-red-500 font-bold animate-pulse">PAUSED</div>
            <button onclick="navigateTo('settings-page')" class="p-2 hover:bg-white/5 rounded-lg transition-colors border border-transparent hover:border-white/10">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 mt-8">
        
        <!-- Home Dashboard -->
        <div id="home-page" class="page active">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 mb-10">
                <div>
                    <h2 class="text-4xl font-extrabold tracking-tight">System Terminal</h2>
                    <p class="text-slate-400 mt-2">Connect to simulation nodes and manage assets.</p>
                </div>
                
                <button id="pause-btn" onclick="togglePause()" class="glass-panel px-6 py-3 rounded-2xl flex items-center gap-3 font-semibold text-sm hover:bg-white/10 transition-all active:scale-95">
                    <span id="pause-btn-icon">⏸</span>
                    <span id="pause-btn-text">Pause Simulation</span>
                </button>
            </div>

            <!-- Main App Grid -->
            <div id="links-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Links injected here by JS -->
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page max-w-2xl mx-auto">
            <div class="glass-panel rounded-3xl p-8">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-2xl font-bold">System Settings</h2>
                    <button onclick="navigateTo('home-page')" class="text-slate-400 hover:text-white text-sm font-medium">Close</button>
                </div>
                
                <div class="space-y-6">
                    <!-- Storage Access Section -->
                    <div class="bg-blue-600/10 p-6 rounded-2xl border border-blue-500/20">
                        <label class="block text-xs font-bold text-blue-400 uppercase tracking-widest mb-3">Data Management</label>
                        <p class="text-sm text-slate-300 mb-4">Access external storage nodes and archived simulation data.</p>
                        <button onclick="window.open('https://rubiks13.github.io/storage', '_blank')" class="w-full bg-blue-600 hover:bg-blue-500 py-3 rounded-xl font-bold text-sm transition-all flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 8V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v3"/><path d="M21 16v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3"/><rect width="20" height="8" x="2" y="8" rx="2"/></svg>
                            Open Storage Terminal
                        </button>
                    </div>

                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                        <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Add New Security Pass</label>
                        <input type="text" id="new-name-input" class="bg-slate-900/50 border border-white/10 rounded-xl px-4 py-3 w-full mb-3 text-sm focus:border-blue-500 outline-none transition-all" placeholder="Enter Full Name">
                        <div class="flex gap-3">
                            <input type="text" id="new-key-input" class="bg-slate-900/50 border border-white/10 rounded-xl px-4 py-3 w-full text-sm font-mono focus:border-blue-500 outline-none transition-all" placeholder="Secret Key">
                            <button onclick="addKey()" class="bg-slate-700 hover:bg-slate-600 px-6 py-3 rounded-xl font-bold text-sm transition-all active:scale-95">Register</button>
                        </div>
                    </div>

                    <div id="keys-list" class="space-y-3">
                        <!-- Keys list here -->
                    </div>

                    <div class="pt-6 border-t border-white/10">
                        <button onclick="if(confirm('Reset all system data?')) { localStorage.clear(); location.reload(); }" class="text-red-400 text-xs font-semibold uppercase tracking-wider hover:text-red-300">Factory Reset System</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Biometric/Key Lock -->
    <div id="lock-screen">
        <div class="w-20 h-20 bg-blue-600 rounded-3xl flex items-center justify-center mb-8 shadow-2xl shadow-blue-500/40">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
        </div>
        <h2 class="text-white text-3xl font-black mb-2">ACCESS RESTRICTED</h2>
        <p class="text-slate-500 mb-8 font-medium">Please scan your security pass to enter.</p>
        <input type="password" id="password-input" placeholder="••••••••" autocomplete="off">
    </div >

    <script>
        const linkData = [
            { 
                name: "Central Bank", 
                id: "bank", 
                base: "https://rubiks13.github.io/bank/", 
                color: "from-emerald-500/20 to-emerald-700/20",
                icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>`,
                desc: "Manage balance and transactions."
            },
            { 
                name: "International Airport", 
                id: "airport", 
                base: "https://rubiks13.github.io/airplane/", 
                color: "from-blue-500/20 to-blue-700/20",
                icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"><path d="M17.8 19.2L16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.3c.4-.2.6-.7.5-1.1z"/></svg>`,
                desc: "Flight schedules and departures."
            },
            { 
                name: "DoorDash Hub", 
                id: "doordash", 
                base: "https://rubiks13.github.io/food/", 
                color: "from-red-500/20 to-red-700/20",
                icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>`,
                desc: "Food delivery logistics."
            },
            { 
                name: "Amazon Logistics", 
                id: "amazon", 
                base: "https://rubiks13.github.io/amazon/", 
                color: "from-orange-500/20 to-orange-700/20",
                icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2"><path d="M21 8l-9-4-9 4v8l9 4 9-4V8z"/><path d="M12 22V12"/><path d="M3.3 7l8.7 5 8.7-5"/></svg>`,
                desc: "Supply chain and package tracking."
            },
            { 
                name: "City Taxi Service", 
                id: "taxi", 
                base: "https://rubiks13.github.io/taxi/", 
                color: "from-yellow-500/20 to-yellow-700/20",
                icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"><rect x="1" y="3" width="22" height="13" rx="2"/><path d="M7 21h10"/><path d="M12 16v5"/></svg>`,
                desc: "Real-time transport mapping."
            }
        ];

        let savedKeys = JSON.parse(localStorage.getItem('bike_occ_keys_v2')) || [];
        let currentUser = { name: "Guest", key: "" };

        function initSimulationClock() {
            function refreshTime() {
                let start = localStorage.getItem('sim_bank_start_real_time');
                let isPaused = localStorage.getItem('sim_is_paused') === 'true';
                let pausedAt = localStorage.getItem('sim_paused_at_ms');

                if(!start) {
                    start = Date.now().toString();
                    localStorage.setItem('sim_bank_start_real_time', start);
                }
                
                const startTime = parseInt(start);
                let elapsedRealMs;

                if (isPaused && pausedAt) {
                    elapsedRealMs = parseInt(pausedAt);
                    document.getElementById('pause-indicator').classList.remove('hidden');
                } else {
                    elapsedRealMs = Date.now() - startTime;
                    document.getElementById('pause-indicator').classList.add('hidden');
                }
                
                const msPerSimDay = 1440000;
                const currentDay = Math.floor(elapsedRealMs / msPerSimDay) + 1;
                const dateString = `DAY ${currentDay}`;

                const totalSimMinutesSinceStart = Math.floor(elapsedRealMs / 1000);
                const currentSimMinutesInDay = totalSimMinutesSinceStart % 1440;
                
                const hours = Math.floor(currentSimMinutesInDay / 60);
                const mins = currentSimMinutesInDay % 60;
                const ampm = hours >= 12 ? 'PM' : 'AM';
                const displayHour = hours % 12 || 12;
                const displayMin = mins.toString().padStart(2, '0');
                const timeString = `${displayHour}:${displayMin} ${ampm}`;

                localStorage.setItem('sim_current_bike_time', timeString);
                localStorage.setItem('sim_current_bike_date', dateString);
                
                document.getElementById('sim-time-text').innerText = timeString;
                document.getElementById('sim-date-text').innerText = dateString;

                const btnIcon = document.getElementById('pause-btn-icon');
                const btnText = document.getElementById('pause-btn-text');
                if (isPaused) {
                    btnIcon.innerText = '▶';
                    btnText.innerText = 'Resume System';
                } else {
                    btnIcon.innerText = '⏸';
                    btnText.innerText = 'Pause System';
                }
            }
            setInterval(refreshTime, 100); 
            refreshTime();
        }

        function togglePause() {
            const isCurrentlyPaused = localStorage.getItem('sim_is_paused') === 'true';
            const startTime = parseInt(localStorage.getItem('sim_bank_start_real_time'));
            
            if (!isCurrentlyPaused) {
                const elapsed = Date.now() - startTime;
                localStorage.setItem('sim_is_paused', 'true');
                localStorage.setItem('sim_paused_at_ms', elapsed.toString());
            } else {
                const pausedAt = parseInt(localStorage.getItem('sim_paused_at_ms'));
                const newStartTime = Date.now() - pausedAt;
                localStorage.setItem('sim_bank_start_real_time', newStartTime.toString());
                localStorage.setItem('sim_is_paused', 'false');
                localStorage.removeItem('sim_paused_at_ms');
            }
        }

        function renderLinks() {
            const container = document.getElementById('links-container');
            container.innerHTML = '';
            linkData.forEach(link => {
                const personalizedUrl = `${link.base}?user=${encodeURIComponent(currentUser.name)}`;
                const card = document.createElement('button');
                card.className = "app-card group relative overflow-hidden rounded-[2.5rem] p-8 text-left h-full flex flex-col items-start";
                card.onclick = () => window.open(personalizedUrl, link.id);
                
                card.innerHTML = `
                    <div class="absolute inset-0 bg-gradient-to-br ${link.color} opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    <div class="relative z-10 w-14 h-14 bg-white/5 rounded-2xl flex items-center justify-center mb-6 border border-white/10 group-hover:scale-110 transition-transform">
                        ${link.icon}
                    </div>
                    <div class="relative z-10 mt-auto">
                        <h3 class="text-xl font-bold mb-2 group-hover:text-white transition-colors">${link.name}</h3>
                        <p class="text-slate-400 text-sm leading-relaxed">${link.desc}</p>
                    </div>
                    <div class="absolute top-8 right-8 text-slate-600 group-hover:text-white transition-colors opacity-0 group-hover:opacity-100">
                         <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M7 17L17 7M17 7H7M17 7V17"/></svg>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function navigateTo(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const target = document.getElementById(pageId);
            target.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            if(pageId === 'settings-page') updateKeysList();
        }

        function updateKeysList() {
            const list = document.getElementById('keys-list');
            list.innerHTML = '';
            savedKeys.forEach((k, i) => {
                const div = document.createElement('div');
                div.className = "bg-white/5 p-4 rounded-xl flex justify-between items-center border border-white/5";
                div.innerHTML = `
                    <div>
                        <p class="font-bold text-sm text-white">${k.name}</p>
                        <p class="font-mono text-[10px] text-slate-500 uppercase tracking-widest">${k.key}</p>
                    </div>
                    <button onclick="removeKey(${i})" class="p-2 text-slate-500 hover:text-red-400 transition-colors">
                        <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                    </button>`;
                list.appendChild(div);
            });
        }

        function removeKey(i) {
            savedKeys.splice(i, 1);
            localStorage.setItem('bike_occ_keys_v2', JSON.stringify(savedKeys));
            updateKeysList();
        }

        function addKey() {
            const k = document.getElementById('new-key-input').value;
            const n = document.getElementById('new-name-input').value || "User";
            if(k) {
                savedKeys.push({key: k, name: n});
                localStorage.setItem('bike_occ_keys_v2', JSON.stringify(savedKeys));
                location.reload();
            }
        }

        function unlock(user) {
            currentUser = user;
            document.getElementById('greeting-text').innerText = `${user.name} Terminal`;
            renderLinks();
            document.getElementById('lock-screen').classList.add('hidden');
        }

        document.getElementById('password-input').addEventListener('input', (e) => {
            const val = e.target.value;
            const match = savedKeys.find(e => e.key === val);
            if(match) unlock(match);
            else if(savedKeys.length === 0 && val === "1") {
                unlock({name:"Administrator", key:"1"});
                navigateTo('settings-page');
            }
        });

        document.addEventListener('click', () => { 
            if(!document.getElementById('lock-screen').classList.contains('hidden')) {
                document.getElementById('password-input').focus();
            }
        });

        window.onload = () => { 
            initSimulationClock(); 
            document.getElementById('password-input').focus(); 
        };
    </script>
</body>
</html>
