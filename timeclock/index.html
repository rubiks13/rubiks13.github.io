<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Time Clock</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glass-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .tap-pulse:active {
            transform: scale(0.95);
        }
        /* Custom modal transition */
        #modal-container {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        .modal-hidden {
            transform: translateY(100%);
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen">
    <div id="app" class="max-w-md mx-auto min-h-screen flex flex-col p-6 relative overflow-hidden">
        
        <!-- Live Timer Display -->
        <div class="flex-1 flex flex-col items-center justify-center text-center space-y-8">
            <div class="space-y-2">
                <h1 id="status-text" class="text-sm font-bold opacity-50 uppercase tracking-widest">Ready to Work</h1>
                <div id="timer-display" class="text-5xl font-black tabular-nums opacity-20 transition-all duration-500">
                    00m 00s
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="w-full space-y-4 px-4">
                <button id="clock-in-btn" onclick="clockIn()" class="w-full py-6 bg-blue-600 text-white rounded-3xl text-xl font-bold shadow-xl shadow-blue-500/20 tap-pulse">
                    Clock In
                </button>
                <button id="clock-out-btn" onclick="clockOut()" class="hidden w-full py-6 bg-red-500 text-white rounded-3xl text-xl font-bold shadow-xl shadow-red-500/20 tap-pulse">
                    Clock Out
                </button>
            </div>

            <div class="p-4 rounded-2xl border border-slate-200 glass-card">
                <p class="text-xs opacity-60 font-bold uppercase">Current Rate</p>
                <p id="rate-display" class="text-lg font-bold text-blue-600">$20.00/hr</p>
            </div>
        </div>

        <!-- Navigation Bar -->
        <div class="mt-auto pt-6 flex justify-between items-center z-10">
            <button onclick="openSettings()" class="p-4 rounded-2xl bg-white shadow-lg text-slate-600 tap-pulse glass-card">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
            
            <button onclick="scrollToHome()" class="p-4 rounded-full bg-blue-600 text-white shadow-xl tap-pulse">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            </button>

            <button onclick="openReports()" class="p-4 rounded-2xl bg-white shadow-lg text-emerald-600 tap-pulse glass-card">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
            </button>
        </div>

        <!-- Dynamic Modal Container -->
        <div id="modal-container" class="fixed inset-0 z-50 bg-slate-50 dark:bg-slate-900 p-6 modal-hidden flex flex-col">
            <div class="flex justify-between items-center mb-8">
                <h2 id="modal-title" class="text-3xl font-extrabold">Settings</h2>
                <button onclick="closeModal()" class="p-3 rounded-full bg-slate-200 dark:bg-slate-800">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                </button>
            </div>
            <div id="modal-content" class="flex-1 overflow-y-auto space-y-6">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <script>
        // State Management
        let state = {
            isClockedIn: false,
            startTime: null,
            hourlyRate: 20,
            isDarkMode: false,
            history: []
        };

        // Initialize from LocalStorage
        function init() {
            const saved = localStorage.getItem('timeClockData');
            if (saved) {
                state = { ...state, ...JSON.parse(saved) };
            }
            
            // Apply Theme
            applyTheme();
            updateDashboard();
            
            // Start Timer Loop
            setInterval(updateTimer, 1000);
        }

        function save() {
            localStorage.setItem('timeClockData', JSON.stringify(state));
            updateDashboard();
        }

        function applyTheme() {
            if (state.isDarkMode) {
                document.documentElement.classList.add('dark');
                document.body.classList.replace('bg-slate-50', 'bg-slate-900');
                document.body.classList.add('text-white');
            } else {
                document.documentElement.classList.remove('dark');
                document.body.classList.replace('bg-slate-900', 'bg-slate-50');
                document.body.classList.remove('text-white');
            }
        }

        function updateDashboard() {
            const btnIn = document.getElementById('clock-in-btn');
            const btnOut = document.getElementById('clock-out-btn');
            const statusText = document.getElementById('status-text');
            const timerDisplay = document.getElementById('timer-display');
            const rateDisplay = document.getElementById('rate-display');

            rateDisplay.innerText = `$${state.hourlyRate.toFixed(2)}/hr`;

            if (state.isClockedIn) {
                btnIn.classList.add('hidden');
                btnOut.classList.remove('hidden');
                statusText.innerText = 'Shift in Progress';
                timerDisplay.classList.remove('opacity-20');
                timerDisplay.classList.add('text-blue-600', 'scale-110');
            } else {
                btnIn.classList.remove('hidden');
                btnOut.classList.add('hidden');
                statusText.innerText = 'Ready to Work';
                timerDisplay.classList.add('opacity-20');
                timerDisplay.classList.remove('text-blue-600', 'scale-110');
                timerDisplay.innerText = '00m 00s';
            }
        }

        function clockIn() {
            state.isClockedIn = true;
            state.startTime = Date.now();
            save();
        }

        function clockOut() {
            if (!state.isClockedIn) return;
            const endTime = Date.now();
            const durationMs = endTime - state.startTime;
            
            state.history.push({
                start: state.startTime,
                end: endTime,
                durationMs: durationMs,
                rate: state.hourlyRate
            });

            state.isClockedIn = false;
            state.startTime = null;
            save();
        }

        function updateTimer() {
            if (!state.isClockedIn) return;
            const diff = Date.now() - state.startTime;
            document.getElementById('timer-display').innerText = formatTime(diff);
        }

        function formatTime(ms) {
            const totalSec = Math.floor(ms / 1000);
            const h = Math.floor(totalSec / 3600);
            const m = Math.floor((totalSec % 3600) / 60);
            const s = totalSec % 60;
            return h > 0 ? `${h}h ${m}m ${s}s` : `${m}m ${s}s`;
        }

        // Modal Handlers
        function closeModal() {
            document.getElementById('modal-container').classList.add('modal-hidden');
        }

        function openSettings() {
            const container = document.getElementById('modal-container');
            const title = document.getElementById('modal-title');
            const content = document.getElementById('modal-content');

            title.innerText = "Settings";
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="space-y-2">
                        <label class="text-xs font-bold opacity-50 uppercase">Hourly Pay Rate</label>
                        <div class="flex items-center p-4 bg-slate-100 dark:bg-slate-800 rounded-2xl">
                            <span class="mr-2 font-bold text-slate-400">$</span>
                            <input type="number" id="rate-input" value="${state.hourlyRate}" onchange="updateRate(this.value)" class="bg-transparent w-full outline-none font-bold text-lg">
                        </div>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-slate-100 dark:bg-slate-800 rounded-2xl cursor-pointer" onclick="toggleTheme()">
                        <div class="flex items-center gap-3">
                            <span class="font-bold">Dark Mode</span>
                        </div>
                        <div class="w-12 h-6 rounded-full bg-slate-300 dark:bg-blue-600 relative transition-colors">
                            <div class="absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-all ${state.isDarkMode ? 'translate-x-6' : ''}"></div>
                        </div>
                    </div>

                    <button onclick="clearAllData()" class="w-full p-4 text-red-500 font-bold bg-red-50 dark:bg-red-900/20 rounded-2xl mt-8">
                        Clear All History
                    </button>
                </div>
            `;
            container.classList.remove('modal-hidden');
        }

        function openReports() {
            const container = document.getElementById('modal-container');
            const title = document.getElementById('modal-title');
            const content = document.getElementById('modal-content');

            const totalMs = state.history.reduce((acc, s) => acc + s.durationMs, 0);
            const totalHours = (totalMs / 3600000).toFixed(2);
            const totalPay = state.history.reduce((acc, s) => acc + ((s.durationMs / 3600000) * s.rate), 0).toFixed(2);

            title.innerText = "Earnings";
            content.innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-6 rounded-3xl bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800">
                        <p class="text-xs font-bold text-blue-500 uppercase mb-1">Total Hours</p>
                        <p class="text-3xl font-black">${totalHours}</p>
                    </div>
                    <div class="p-6 rounded-3xl bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-100 dark:border-emerald-800">
                        <p class="text-xs font-bold text-emerald-500 uppercase mb-1">Due Pay</p>
                        <p class="text-3xl font-black text-emerald-600">$${totalPay}</p>
                    </div>
                </div>

                <div class="space-y-4 pt-4">
                    <h3 class="font-bold opacity-50">Recent Shifts</h3>
                    ${state.history.slice().reverse().map(shift => `
                        <div class="p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm flex justify-between items-center">
                            <div>
                                <p class="text-xs opacity-50">${new Date(shift.start).toLocaleDateString()}</p>
                                <p class="font-bold">${(shift.durationMs / 3600000).toFixed(2)} hrs</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs opacity-50">$${shift.rate}/hr</p>
                                <p class="font-bold text-emerald-500">$${((shift.durationMs / 3600000) * shift.rate).toFixed(2)}</p>
                            </div>
                        </div>
                    `).join('') || '<p class="text-center opacity-30 py-8">No shifts recorded.</p>'}
                </div>
            `;
            container.classList.remove('modal-hidden');
        }

        function updateRate(val) {
            state.hourlyRate = parseFloat(val) || 0;
            save();
        }

        function toggleTheme() {
            state.isDarkMode = !state.isDarkMode;
            applyTheme();
            save();
            openSettings(); // Refresh UI
        }

        function clearAllData() {
            if (confirm("Reset everything? Your history will be deleted forever.")) {
                state.history = [];
                save();
                openSettings();
            }
        }

        function scrollToHome() {
            closeModal();
        }

        // Initialize
        init();
    </script>
</body>
</html>
